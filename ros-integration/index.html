<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
	<script>
		renderMathInElement(document.body,
			{
				delimiters: [
					{left: "$$", right: "$$", display: true},
					{left: "$", right: "$", display: false},
				]
			}
		);

		var inlineMathArray = document.querySelectorAll("script[type='math/tex']");
		for (var i = 0; i < inlineMathArray.length; i++) {
			var inlineMath = inlineMathArray[i];
			var tex = inlineMath.innerText || inlineMath.textContent;
			var replaced = document.createElement("span");
			replaced.innerHTML = katex.renderToString(tex, {displayMode: false});
			inlineMath.parentNode.replaceChild(replaced, inlineMath);
		}

		var displayMathArray = document.querySelectorAll("script[type='math/tex; mode=display']");
		for (var i = 0; i < displayMathArray.length; i++) {
			var displayMath = displayMathArray[i];
			var tex = displayMath.innerHTML;
			var replaced = document.createElement("span");
			replaced.innerHTML = katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
			displayMath.parentNode.replaceChild(replaced, displayMath);
		}
	</script>

    
    
    
    
    
    
    

    
    
    

    <link rel="canonical" href="https://nuhuo08.github.io/ros-integration/">
    <meta name="generator" content="Hugo 0.62.2" />
    <title>ROS Integration | XiaoWu</title>

    
    <link rel="stylesheet" href="/css/uswds.min.c480a9b2a1fc1e7e564e62752462b22cd5f508a047f0340cb3725722f627fb1d.css">
    
    
    <link rel="stylesheet" href="/css/custom.0a518097f5500782b25662ab2af4088600eefcc3d2d8828ce721e5e5fee436b5.min.css">
  </head>
  <body>
    <a class="usa-skipnav" href="#main-content">Skip to main content</a>

    <header class="usa-header usa-header--basic" role="banner">
      <div class="usa-nav-container">
        <div class="usa-navbar">
          <div class="usa-logo" id="basic-mega-logo">
            <em class="usa-logo__text">
              <a href="/" title="Home" aria-label="Home">XiaoWu</a>
            </em>
          </div>
          <button class="usa-menu-btn">Menu</button>
        </div>

        <nav role="navigation" class="usa-nav">
          <button class="usa-nav__close">
            <img src="/img/close.svg" alt="close" />
          </button>
          <ul class="usa-nav__primary usa-accordion">
            
            
              
              
              
              
              <li class="usa-nav__primary-item">
                <a class="usa-nav__link " href="/">
                  <span>Home</span>
                </a>
              </li>
            
          </ul>
        </nav>
      </div>
    </header>

    <main class="usa-section" id="main-content">
      <div class="grid-container">
        <div class="grid-row grid-gap">
          <div class="tablet:grid-col usa-prose">
            
  <h1>ROS Integration</h1>
  
  <p class="text-gray-50">
    
    
    
    <strong>Published: </strong>2020-01-15

    
    
      
      
        | <strong>Lastmod: </strong>2020-03-16

      
    
    
    
    
    </span>
  </p>
  
  
    

<div class="toc">
  <strong>Table of contents</strong>
  <ol>
    
    <li>
      
      
      
      
      <a href="#%e8%87%aa%e5%8a%a8%e9%a9%be%e9%a9%b6%e7%b3%bb%e7%bb%9f%e7%bb%93%e6%9e%84">
        自动驾驶系统结构
      </a>
    </li>
    
    <li>
      
      
      
      
      <a href="#%e6%af%95%e4%b8%9a%e8%af%be%e7%a8%8b%e9%a1%b9%e7%9b%ae">
        毕业课程项目
      </a>
    </li>
    
    <li>
      
      
      
      
      <a href="#%e5%85%b6%e4%bb%96">
        其他
      </a>
    </li>
    
  </ol>
</div>


  
  
  

<h2 id="自动驾驶系统结构">自动驾驶系统结构 <a aria-label="header link for 自动驾驶系统结构" href="#自动驾驶系统结构" class="header-link">#</a></h2>











  


<div class="usa-image-block">
  <a href="/ros-integration/systems-integration.png">
    <img src="/ros-integration/systems-integration.png" alt="Systems Integration">
  </a>
  <div class="usa-image-text-block">
    <p class="usa-image-text text-gray-50"></p>
  </div>
</div>


<p>在繁忙的工作之余，学习完这门课
<a href="https://www.udacity.com/course/self-driving-car-engineer-nanodegree--nd013">Udacity - Self-Driving Car Engineer</a>，
虽然辛苦，但是收货很多。
对无人车上配置的传感器、涉及到的功能模块、各模块之间的交互都有了大致的了解。
更有幸的是参与了自动泊车系统的研发、重构、优化等一个几乎完整的工程项目开发周期。</p>

<h2 id="毕业课程项目">毕业课程项目 <a aria-label="header link for 毕业课程项目" href="#毕业课程项目" class="header-link">#</a></h2>











  


<div class="usa-image-block">
  <a href="/ros-integration/final-project.png">
    <img src="/ros-integration/final-project.png" alt="Final Project">
  </a>
  <div class="usa-image-text-block">
    <p class="usa-image-text text-gray-50"></p>
  </div>
</div>


<p>Nanodegree毕业课程设计，该图包含了项目涉及到的几个ROS Node，以及系统中流动的ROS Message。</p>

<h3 id="tldetector">tl_detector</h3>











  


<div class="usa-image-block">
  <a href="/ros-integration/tl_detector.png">
    <img src="/ros-integration/tl_detector.png" alt="Traffic Light Detector">
  </a>
  <div class="usa-image-text-block">
    <p class="usa-image-text text-gray-50"></p>
  </div>
</div>


<p>根据图像信息：</p>

<ol>
<li>检测是否存在红绿灯标牌</li>
<li>分类是红灯还是绿灯</li>
</ol>

<p>若检测到红灯，则将最靠近停止线的waypoint的序号发送出去。</p>

<p>TODO: 增加OpenCV Image Processing &amp; Deep Learning跳转链接</p>

<h3 id="waypointupdater">waypoint_updater</h3>











  


<div class="usa-image-block">
  <a href="/ros-integration/waypoint_updater.png">
    <img src="/ros-integration/waypoint_updater.png" alt="Waypoint Updater">
  </a>
  <div class="usa-image-text-block">
    <p class="usa-image-text text-gray-50"></p>
  </div>
</div>


<p>生成前面一段需要跟踪的路径点，且增加了速度属性。当前方存在红灯时，会设置waypoints的速度慢慢减少到0停止。</p>

<h3 id="waypointfollower">waypoint_follower</h3>

<p>采用pure pursuit算法，计算出车辆需要输出的线速度和角速度，以geometry_msgs::TwistStamped消息发送出去。</p>

<h3 id="twistcontroller">twist_controller</h3>











  


<div class="usa-image-block">
  <a href="/ros-integration/twist_controller.png">
    <img src="/ros-integration/twist_controller.png" alt="Twist Controller">
  </a>
  <div class="usa-image-text-block">
    <p class="usa-image-text text-gray-50"></p>
  </div>
</div>


<p>使用PID控制器，通过brake/throttle控制车辆的加减速度，使之达到期望的线速度。<br>
使用YawController控制器，计算打方向盘的角度。</p>

<p>控制的原理可参考 <a href="../control">Control</a>。</p>

<h2 id="其他">其他 <a aria-label="header link for 其他" href="#其他" class="header-link">#</a></h2>

<p>该项目没有涉及路径规划、位置确定、障碍物跟踪模块。</p>

<h3 id="planning">Planning</h3>

<p>实际自动驾驶中，汽车跟踪的轨迹预先是不知道的，所以不会有Waypoint Loader模块。
需要根据用户的需求，做出正确的路径规划。</p>

<ol>
<li>类似于导航软件，根据用户指定的目的地，输出一条全局路径规划。</li>
<li>在跟踪全局路径时，需要有局部路径规划，控制车辆轨迹的平滑稳定。</li>
</ol>

<p>路径规划的原理可参考这两篇博客：<a href="../path-planning">Path Planning</a>，<a href="../move_base/#规划和控制">ROS 路径规划</a></p>

<h3 id="positioning">Positioning</h3>

<p>实际车辆在运行过程中，不会精确知道自己的位姿。定位所涉及的方法有：</p>

<ol>
<li>GPS/INS</li>
<li>Odometry</li>
<li>Visual/Lidar SLAM</li>
<li>HD Map Matching</li>
</ol>

<h3 id="障碍物跟踪">障碍物跟踪</h3>

<p>融合多传感器的感知结果，预测与追踪障碍物的轨迹。</p>



  
    <br>
    <strong>Next:</strong> <a href="/gps-ins/">GPS/INS组合导航</a>
  

  
    <br>
    <strong>Previous:</strong> <a href="/loam/">LOAM</a>
  
  
  
    <div id="utter-container">
    <script src="https://utteranc.es/client.js"
        repo= 'nuhuo08/blog-comments'
        issue-term= "pathname"
        theme= 'github-light'
        crossorigin= "anonymous"
        async>
    </script> 
    </div>

  


          </div>
        </div>
      </div>
    </main>

    <footer class="usa-footer usa-footer--slim" role="contentinfo">
      
      <div class="usa-footer__secondary-section" id="footer-main">
        <div class="grid-container">
          <div class="grid-row grid-gap">
            <div class="grid-col-12 text-center">
              
              
                Made with <a href="https://gohugo.io/">Hugo</a> • Content in <a href="https://github.com/nuhuo08/uswds-hugo-theme">GitHub</a>
                <br>
                Last deployed on 2020-03-17
              

              

            </div>
          </div>
        </div>
      </div>
    </footer>

    
    <script src="/js/uswds.min.fcd9b25a27c51de427f4c618dee88490c2ff0a792a573531e316730d07df3f3d.js"></script>

  </body>
</html>
